#!/bin/bash

find Malware-Files/Files/Crypto-Miners/ -ls  | while read line
  do
    fileName=$(echo $line | awk '{ print $11}')
    CryptoBot=$(tar -tzf "$fileName" 2>/dev/null)

    if [[ "$CryptoBot" == *".rsync/c/slow"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm"* ]] && [[ "$CryptoBot" == *".rsync/c/watchdog"* ]] && [[ "$CryptoBot" == *".rsync/c/run"* ]] && [[ "$CryptoBot" == *".rsync/c/go"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm32"* ]] && [[ "$CryptoBot" == *".rsync/c/tsmv7"* ]] && [[ "$CryptoBot" == *".rsync/c/start"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm64"* ]] && [[ "$CryptoBot" == *".rsync/c/stop"* ]] && [[ "$CryptoBot" == *".rsync/c/v"* ]] && [[ "$CryptoBot" == *".rsync/c/golan"* ]] && [[ "$CryptoBot" == *".rsync/init"* ]] && [[ "$CryptoBot" == *".rsync/init2"* ]] && [[ "$CryptoBot" == *".rsync/initall"* ]] && [[ "$CryptoBot" == *".rsync/a/"* ]] && [[ "$CryptoBot" == *".rsync/a/anacron"* ]] && [[ "$CryptoBot" == *".rsync/a/run"* ]] && [[ "$CryptoBot" == *".rsync/a/stop"* ]] && [[ "$CryptoBot" == *".rsync/a/a"* ]] && [[ "$CryptoBot" == *".rsync/a/cron"* ]];
    then
    cp $fileName Malware-Files/Files/Crypto-Miners/Identified-Miners/Crypto-Miner1 > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 |  echo "Organizing found Crypto-Miners...Crypto-Bot-Version 1 Found"

    elif [[ "$CryptoBot" == *".rsync/c/slow"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm"* ]] && [[ "$CryptoBot" == *".rsync/c/watchdog"* ]] && [[ "$CryptoBot" == *".rsync/c/run"* ]] && [[ "$CryptoBot" == *".rsync/c/go"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm32"* ]] && [[ "$CryptoBot" == *".rsync/c/tsmv7"* ]] && [[ "$CryptoBot" == *".rsync/c/start"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm64"* ]] && [[ "$CryptoBot" == *".rsync/c/stop"* ]] && [[ "$CryptoBot" == *".rsync/c/v"* ]] && [[ "$CryptoBot" == *".rsync/c/golan"* ]] && [[ "$CryptoBot" == *".rsync/init"* ]] && [[ "$CryptoBot" == *".rsync/init2"* ]] && [[ "$CryptoBot" == *".rsync/initall"* ]] && [[ "$CryptoBot" == *".rsync/a/"* ]] && [[ "$CryptoBot" == *".rsync/a/anacron"* ]];
    then
    cp $fileName Malware-Files/Files/Crypto-Miners/Identified-Miners/Crypto-Miner2 > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...Crypto-Bot-Version 2 Found"

    elif [[ "$CryptoBot" == *".rsync/c/slow"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm"* ]] && [[ "$CryptoBot" == *".rsync/c/watchdog"* ]] && [[ "$CryptoBot" == *".rsync/c/run"* ]] && [[ "$CryptoBot" == *".rsync/c/go"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm32"* ]] && [[ "$CryptoBot" == *".rsync/c/tsmv7"* ]] && [[ "$CryptoBot" == *".rsync/c/start"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm64"* ]];
    then
    cp $fileName Malware-Files/Files/Crypto-Miners/Identified-Miners/Crypto-Miner3 > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...Crypto-Bot-Version 3 Found"

    elif [[ "$CryptoBot" == *".rsync/c/slow"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm"* ]] && [[ "$CryptoBot" == *".rsync/c/watchdog"* ]] && [[ "$CryptoBot" == *".rsync/c/run"* ]] && [[ "$CryptoBot" == *".rsync/c/go"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm32"* ]] && [[ "$CryptoBot" == *".rsync/c/start"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm64"* ]];
    then
    cp $fileName Malware-Files/Files/Crypto-Miners/Identified-Miners/Crypto-Miner4 > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...Crypto-Bot-Version 4 Found"

    elif [[ "$CryptoBot" == *".rsync/c/slow"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm"* ]] && [[ "$CryptoBot" == *".rsync/c/watchdog"* ]] && [[ "$CryptoBot" == *".rsync/c/run"* ]] && [[ "$CryptoBot" == *".rsync/c/go"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm32"* ]] && [[ "$CryptoBot" == *".rsync/c/tsmv7"* ]];
    then
    cp $fileName Malware-Files/Files/Crypto-Miners/Identified-Miners/Crypto-Miner5 > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...Crypto-Bot-Version 5 Found"

    elif [[ "$CryptoBot" == *".rsync/c/slow"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm"* ]] && [[ "$CryptoBot" == *".rsync/c/watchdog"* ]] && [[ "$CryptoBot" == *".rsync/c/run"* ]] && [[ "$CryptoBot" == *".rsync/c/go"* ]] && [[ "$CryptoBot" == *".rsync/c/tsm32"* ]];
    then
    cp $fileName Malware-Files/Files/Crypto-Miners/Identified-Miners/Crypto-Miner6 > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...Crypto-Bot-Version 6 Found"

    else
    cp $fileName Malware-Files/Files/Crypto-Miners/Unidentified-Miners/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...Unknown Signature Detected"

    fi

done
